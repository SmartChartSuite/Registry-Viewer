<div>
  <h2 mat-dialog-title>Annotations</h2>
  <mat-dialog-content>

    <div style="margin-top: 1em" *ngIf="isAddAnnotationFormVisible" [formGroup]="form">
      <mat-card class="mat-elevation-z4">
        <div>
          <mat-form-field appearance="outline">
            <mat-label>Select Flag</mat-label>
            <mat-select formControlName="flag">
              <mat-option value="One">One</mat-option>
              <mat-option value="Two">Two</mat-option>
              <mat-option value="Three">Three</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" [style.width.%]=100>
            <mat-label>Annotation Text</mat-label>
            <textarea rows="10" cols="50"
                      matInput
                      placeholeder="Annotation Text"
                      formControlName="textValue">
            </textarea>
          </mat-form-field>
        </div>

        <div align="end">
          <button mat-raised-button color="primary" (click)="save()">
            <mat-icon>note_add</mat-icon>
            Add Annotation
          </button>
        </div>
      </mat-card>
    </div>
    <div style="margin-top: 2em">
      <mat-card class="mat-elevation-z4">
      <button *ngIf="isExpandAllBtnVisible" mat-raised-button color="primary" (click)="expandAll()">
        <mat-icon>expand</mat-icon>
        Expand All
      </button>
      <button *ngIf="!isExpandAllBtnVisible" mat-raised-button color="primary" (click)="collapseAll()">
        <mat-icon>unfold_less</mat-icon>
        Collapse All
      </button>

      <table mat-table
             [dataSource]="dataSource" multiTemplateDataRows>

        <ng-container matColumnDef="flag">
          <th mat-header-cell *matHeaderCellDef>Flag</th>
          <th mat-header-cell *matHeaderCellDef>Flag</th>
          <td mat-cell *matCellDef="let annotation"> {{annotation.flag}} </td>
        </ng-container>

        <ng-container matColumnDef="updated">
          <th mat-header-cell *matHeaderCellDef> Updated</th>
          <td mat-cell *matCellDef="let annotation"> {{annotation.updated | date}} </td>
        </ng-container>

        <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
        <ng-container matColumnDef="expandedDetail">
          <td mat-cell *matCellDef="let annotation" [attr.colspan]="columnsToDisplay.length">
            <div class="annotation-detail"
                 [@detailExpand]="annotation.expanded ? 'expanded' : 'collapsed'">
              <div class="annotation-text-value">
                {{annotation.textValue}}
              </div>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let annotation; columns: columnsToDisplay;"
            class="annotation-row"
            (click)="annotation.expanded = !annotation.expanded">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="text-value-row"></tr>
      </table>
      </mat-card>
    </div>


  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-raised-button (click)="close()">Close</button>
  </mat-dialog-actions>

</div>
