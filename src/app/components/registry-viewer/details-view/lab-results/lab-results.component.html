<mat-card>
  <mat-card-header>
    <mat-card-title>Lab Results</mat-card-title>
  </mat-card-header>

  <mat-card-content style="margin-top:20px" [style.overflow]="'auto'" [style.height.%]="matCardContentHeight">
    <table>
      <thead>
      <tr>
        <th>Group</th>
        <th>Date</th>
        <th>Test</th>
        <th>Result</th>
        <th>Note</th>
      </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let labResult of labResultsFormatted">
        <tr>
          <td [attr.rowspan]="labResult.values.length" style="font-weight: bold;  width: 20%;">{{labResult.group}}</td>
          <td class="data-cell" (click)="onViewDetails(labResult.values[0])">{{labResult.values[0].date | date:'mediumDate'}}</td>
          <td class="data-cell" matTooltip="View Details" (click)="onViewDetails(labResult.values[0])">{{labResult.values[0].test}}</td>
          <td class="data-cell"  matTooltip="View Details" (click)="onViewDetails(labResult.values[0])">{{labResult.values[0].result}}</td>
          <td style="cursor: pointer; color: #3F51B5">
            <mat-icon matTooltip="Add Annotation" (click)="onEditAnnotation(labResult.values[0])">edit_note</mat-icon>
          </td>
        </tr>
        <ng-container *ngFor="let testData of labResult.values; let i = index;">
          <tr *ngIf="i!=0">
            <td class="data-cell" matTooltip="View Details" (click)="onViewDetails(testData)">{{testData.date | date:'mediumDate'}}</td>
            <td class="data-cell" matTooltip="View Details" (click)="onViewDetails(testData)">{{testData.test}}</td>
            <td class="data-cell" matTooltip="View Details" (click)="onViewDetails(testData)">{{testData.result}}</td>
            <td style="cursor: pointer; color: #3F51B5">
              <mat-icon matTooltip="Add Annotation" (click)="onEditAnnotation(testData)">edit_note</mat-icon>
            </td>
          </tr>
        </ng-container>
      </ng-container>
      </tbody>
    </table>
  </mat-card-content>

  <mat-card-actions align="end">
    <button mat-raised-button color="primary">
      <mat-icon>add</mat-icon>
      Add Result
    </button>
  </mat-card-actions>

</mat-card>
